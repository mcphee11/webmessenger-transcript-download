<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Google Tag Manager -->
    <script>
      ;(function (w, d, s, l, i) {
        w[l] = w[l] || []
        w[l].push({
          'gtm.start': new Date().getTime(),
          event: 'gtm.js',
        })
        var f = d.getElementsByTagName(s)[0],
          j = d.createElement(s),
          dl = l != 'dataLayer' ? '&l=' + l : ''
        j.async = true
        j.src = 'https://www.googletagmanager.com/gtm.js?id=' + i + dl
        f.parentNode.insertBefore(j, f)
      })(window, document, 'script', 'dataLayer', 'GTM-P556WRQ')
    </script>
    <!-- End Google Tag Manager -->
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!--Removes Google Crawler from indexing page-->
    <meta name="robots" content="noindex" />
    <title>Web Messaging</title>
    <!--Genesys Cloud CSS Formatting Start-->
    <link href="https://dhqbrvplips7x.cloudfront.net/common-ui-docs/genesys-webcomponents/3.8.0-172/genesys-webcomponents/genesys-webcomponents.css" rel="stylesheet" />
    <script type="module" src="https://dhqbrvplips7x.cloudfront.net/common-ui-docs/genesys-webcomponents/3.8.0-172/genesys-webcomponents/genesys-webcomponents.esm.js"></script>
    <!--Genesys Cloud CSS Formatting End-->
    <script>
      const gc_deploymentId = '89dd9f50-b351-4a6b-958c-0584d2eccd02'
      const gc_region = 'mypurecloud.com.au'
      const gc_hexColor = '#000000'
      const gc_iconColor = 'white'
    </script>
    <script>
      ;(function (g, e, n, es, ys) {
        g['_genesysJs'] = e
        g[e] =
          g[e] ||
          function () {
            ;(g[e].q = g[e].q || []).push(arguments)
          }
        g[e].t = 1 * new Date()
        g[e].c = es
        ys = document.createElement('script')
        ys.async = 1
        ys.src = n
        ys.charset = 'utf-8'
        document.head.appendChild(ys)
      })(window, 'Genesys', 'https://apps.mypurecloud.com.au/genesys-bootstrap/genesys.min.js', { environment: 'apse2', deploymentId: gc_deploymentId, debug: false })
    </script>
    <script src="https://unpkg.com/pdf-lib/dist/pdf-lib.min.js"></script>
    <script src="https://unpkg.com/@pdf-lib/fontkit/dist/fontkit.umd.js"></script>
    <script src="./genesysTranscript.js"></script>
  </head>

  <body>
    <!-- Google Tag Manager (noscript) -->
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-P556WRQ" height="0" width="0" style="display: none; visibility: hidden"></iframe></noscript>
    <!-- End Google Tag Manager (noscript) -->
    <script>
      function pageView() {
        var date = new Date()
        var clock = date.getTime()
        clock.toString()
        console.log(clock)
        Genesys('command', 'Journey.pageview', { pageTitle: "'" + clock + "'", pageLocation: "'" + clock + "'" })
      }

      function home() {
        document.location.href = 'http://localhost:8080/index.html'
      }

      function openChat() {
        Genesys('command', 'Messenger.open')
      }

      function closeChat() {
        Genesys('command', 'Messenger.close')
      }

      function addProduct() {
        Genesys('command', 'Journey.record', { eventName: 'product_added', customAttributes: { price: 15.99, code: 'CDE-123', name: 'Product', hasBatteries: false } })
      }

      function removeProduct() {
        Genesys('command', 'Journey.record', { eventName: 'product_removed', customAttributes: { price: 15.99, code: 'CDE-123', name: 'Product', hasBatteries: false } })
      }

      function triggerTest() {
        Genesys('command', 'Journey.record', { eventName: 'MattTest', customAttributes: { MattTest: 'test' } })
      }

      function clearSession() {
        localStorage.removeItem(`_${gc_deploymentId}:gcmcopn`)
        localStorage.removeItem(`_${gc_deploymentId}:gcmcsessionActive`)
        Genesys('command', 'Identifiers.purgeAll', {})
        home()
      }
    </script>
    <h1>Genesys Web Messaging Testing</h1>
    <br />
    <gux-card-beta accent="raised">
      <div>
        <gux-button onclick="pageView()" style="min-width: 150px"> <gux-icon icon-name="clock"></gux-icon><span>PageView Unix</span> </gux-button>
        <gux-button onclick="home()" style="min-width: 150px"> <gux-icon icon-name="home"></gux-icon><span>PageView Home</span> </gux-button>
      </div>
      <br />
      <br />
      <div>
        <gux-button onclick="openChat()" style="min-width: 150px"> <gux-icon icon-name="chat"></gux-icon><span>Open Chat</span> </gux-button>
        <gux-button onclick="closeChat()" style="min-width: 150px"> <gux-icon icon-name="chat-disable"></gux-icon><span>Close Chat</span> </gux-button>
      </div>
      <br />
      <br />
      <div>
        <gux-button onclick="addProduct()" style="min-width: 150px"> <gux-icon icon-name="cjv-product-added"></gux-icon><span>Add Product</span> </gux-button>
        <gux-button onclick="removeProduct()" style="min-width: 150px"> <gux-icon icon-name="cjv-product-removed"></gux-icon><span>Remove Product</span> </gux-button>
      </div>
      <br />
      <br />
      <div>
        <gux-button onclick="triggerTest()" style="min-width: 150px"> <gux-icon icon-name="bolt"></gux-icon><span>Trigger Test</span> </gux-button>
        <gux-button onclick="clearSession()" accent="primary" style="min-width: 150px"> <gux-icon icon-name="trashcan"></gux-icon><span>Clear Session</span> </gux-button>
      </div>
    </gux-card-beta>
  </body>
</html>
